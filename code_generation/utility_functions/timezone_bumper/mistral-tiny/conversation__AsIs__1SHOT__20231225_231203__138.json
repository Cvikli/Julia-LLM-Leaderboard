[{"content":"Act as a helpful AI assistant","variables":[],"_type":"systemmessage"},{"content":"Write a function `timezone_bumper(dt,bump)` that increases any provided timestamp by `bump::Int` hours (defaults to +3 hours). Make sure it works only for DateTime types and throws an error for Date types.","variables":[],"_type":"usermessage"},{"content":"Here's an example implementation of the `timezone_bumper` function in Haskell:\n\n```haskell\nimport Data.Time (UTCTime, DefaultTime, TimeZone, diffUTCTime, addUTCTime, LocalTime, makeUTCTime, ZonedTime, secondsToDiffTime, utcTimeZone, defaultTimeZone, error)\n\ntimezoneBumper :: UTCTime -> Int -> Either String UTCTime\ntimezoneBumper dt bump = do\n  let tz = utcTimeZone dt\n  case isUTCTime dt of\n    Just _ -> Right $ addUTCTime (fromIntegral bump * hours) dt\n    Nothing -> Left $ errorMessage\n  where\n    hours = secondsToDiffTime $ fromIntegral 3600\n\n    errorMessage = \"Invalid input: \" ++ show dt ++ \" is not a UTC timestamp.\"\n\ntimezoneBumper _ 0 = Right dt -- Identity function for no bump\ntimezoneBumper dt bump = timezoneBumper dt bump'\n  where\n    bump' = if bump > 0 then bump else abs bump\n\nisUTCTime :: UTCTime -> Maybe ()\nisUTCTime dt = if isUTCTime' dt then Just () else Nothing\n\nisUTCTime' :: UTCTime -> Bool\nisUTCTime' dt = case getTimeZone dt of\n  Just _ -> True\n  Nothing -> False\n\ngetTimeZone :: UTCTime -> Maybe TimeZone\ngetTimeZone = flip getTimeZoneZone dt\n\n-- Example usage:\nmain = do\n  let localTime = makeLocalTime DefaultTime (10, 15, 30) \"America/New_York\" -- Local time in New York\n      utcTime = utcTimeToLocalTime defaultTimeZone localTime -- Convert it to UTC\n      utcTimeWithBump = timezone_bumper utcTime 4 -- Add 4 hours to the UTC time\n  print utcTimeWithBump\n```\n\nThis implementation checks if the given `DateTime` is already in UTC, and if not, it throws an error. It also supports negative hour values by using their absolute value for the addition. The function works for both positive and zero hour bumps, as it is an identity function for no bump.\n\nFeel free to adjust the error message or other parts of the implementation to better suit your needs.","status":200,"tokens":[68,543],"elapsed":4.793643417,"_type":"aimessage"}]